{
  "market_data": {
    "type": "object",
    "properties": {
      "symbol": {"type": "string", "pattern": "^[A-Z]{1,5}$"},
      "timestamp": {"type": "string", "format": "date-time"},
      "open": {"type": "number", "minimum": 0},
      "high": {"type": "number", "minimum": 0},
      "low": {"type": "number", "minimum": 0},
      "close": {"type": "number", "minimum": 0},
      "volume": {"type": "integer", "minimum": 0},
      "source": {"type": "string", "enum": ["polygon", "finnhub", "alpha_vantage"]},
      "timeframe": {"type": "string", "enum": ["1m", "5m", "15m", "1h", "1d"]}
    },
    "required": ["symbol", "timestamp", "open", "high", "low", "close", "volume", "source"],
    "additionalProperties": false
  },
  "technical_indicators": {
    "type": "object",
    "properties": {
      "symbol": {"type": "string", "pattern": "^[A-Z]{1,5}$"},
      "timestamp": {"type": "string", "format": "date-time"},
      "timeframe": {"type": "string", "enum": ["1m", "5m", "15m", "1h", "1d"]},
      "indicators": {
        "type": "object",
        "properties": {
          "sma_20": {"type": "number", "minimum": 0},
          "sma_50": {"type": "number", "minimum": 0},
          "ema_12": {"type": "number", "minimum": 0},
          "ema_26": {"type": "number", "minimum": 0},
          "rsi": {"type": "number", "minimum": 0, "maximum": 100},
          "macd": {"type": "number"},
          "bollinger_upper": {"type": "number", "minimum": 0},
          "bollinger_lower": {"type": "number", "minimum": 0},
          "volume_sma": {"type": "number", "minimum": 0}
        }
      },
      "source": {"type": "string", "enum": ["calculation", "api"]}
    },
    "required": ["symbol", "timestamp", "timeframe", "indicators"],
    "additionalProperties": false
  },
  "ml_predictions": {
    "type": "object",
    "properties": {
      "symbol": {"type": "string", "pattern": "^[A-Z]{1,5}$"},
      "timestamp": {"type": "string", "format": "date-time"},
      "model_version": {"type": "string"},
      "prediction": {"type": "number"},
      "confidence": {"type": "number", "minimum": 0, "maximum": 1},
      "features": {"type": "object"},
      "source": {"type": "string", "enum": ["ml_model"]}
    },
    "required": ["symbol", "timestamp", "model_version", "prediction", "confidence"],
    "additionalProperties": false
  }
}
